__author__ = 'shawnmehan'
import re
import math
import matplotlib.pyplot as plt
from datetime import datetime


first_times = ['2015-06-25 09:50:43.434060', '2015-06-25 11:04:51.875573', '2015-06-25 11:51:53.452883', '2015-06-25 12:50:40.409260', '2015-06-25 13:51:57.781793', '2015-06-25 15:10:06.341513', '2015-06-25 15:54:41.327351', '2015-06-25 17:17:40.466355', '2015-06-25 17:50:52.654397', '2015-06-25 18:51:17.235016', '2015-06-25 20:03:43.146728', '2015-06-25 21:02:48.916735', '2015-06-25 22:21:01.829772', '2015-06-25 23:37:58.276810', '2015-06-25 23:52:17.774209', '2015-06-26 01:01:38.421464', '2015-06-26 01:51:10.537817', '2015-06-26 02:50:46.175776', '2015-06-26 04:08:37.437583', '2015-06-26 04:55:08.490440', '2015-06-26 07:01:51.329659', '2015-06-26 08:37:21.824263', '2015-06-26 08:52:30.103920', '2015-06-26 09:50:40.117137', '2015-06-26 10:57:59.263525', '2015-06-26 12:24:39.836860', '2015-06-26 12:51:37.409698', '2015-06-26 14:29:30.141750', '2015-06-26 14:59:59.712983', '2015-06-26 16:57:03.396955', '2015-06-26 17:51:27.028238', '2015-06-26 19:04:44.199022', '2015-06-26 19:57:13.962546', '2015-06-26 21:20:22.853543', '2015-06-26 21:58:17.190125', '2015-06-26 22:59:44.812051', '2015-06-26 23:50:45.722177', '2015-06-27 00:51:29.137267', '2015-06-27 01:57:42.760208', '2015-06-27 02:56:32.266016', '2015-06-27 04:09:38.218516', '2015-06-27 05:08:01.482101', '2015-06-27 06:53:03.838095', '2015-06-27 07:55:20.827953', '2015-06-27 09:06:54.972518', '2015-06-27 10:14:38.415912', '2015-06-27 10:50:42.257653', '2015-06-27 12:35:28.675595', '2015-06-27 12:51:37.942000', '2015-06-27 14:43:10.245721', '2015-06-27 14:55:46.543933', '2015-06-27 15:52:17.109605', '2015-06-27 16:50:44.011343', '2015-06-27 17:51:09.530370', '2015-06-27 18:59:10.942281', '2015-06-27 19:50:41.387243', '2015-06-27 20:50:40.006732', '2015-06-27 21:50:43.975949', '2015-06-27 22:55:01.002301', '2015-06-27 23:52:28.946127', '2015-06-28 01:04:30.196847', '2015-06-28 03:09:59.594857', '2015-06-28 04:00:57.072380', '2015-06-28 04:50:40.540853', '2015-06-28 05:59:42.096539', '2015-06-28 07:39:41.315215', '2015-06-28 07:52:48.513046', '2015-06-28 09:03:24.795163', '2015-06-28 10:16:55.929868', '2015-06-28 11:15:35.092603', '2015-06-28 11:50:39.973337', '2015-06-28 13:01:08.712206', '2015-06-28 14:02:42.518120', '2015-06-28 15:32:09.950252', '2015-06-28 15:50:42.806085', '2015-06-28 17:00:55.018663', '2015-06-28 18:34:45.440508', '2015-06-28 19:00:58.868689', '2015-06-28 19:50:44.096585', '2015-06-28 22:37:55.086393', '2015-06-28 22:53:04.071313', '2015-06-28 23:53:57.620063', '2015-06-29 01:07:40.130603', '2015-06-29 01:50:40.160458', '2015-06-29 02:50:44.597021', '2015-06-29 03:51:10.695641', '2015-06-29 05:04:38.968818', '2015-06-29 05:54:02.845877', '2015-06-29 07:51:59.378653', '2015-06-29 10:03:56.071927', '2015-06-29 11:17:22.062759', '2015-06-29 11:51:44.141497', '2015-06-29 12:52:46.380713', '2015-06-29 14:03:08.031063', '2015-06-29 15:05:56.113600', '2015-06-29 15:51:14.481722', '2015-06-29 17:04:39.442493', '2015-06-29 17:51:34.090779', '2015-06-29 18:56:59.875080', '2015-06-29 20:12:55.271757', '2015-06-29 20:50:39.580550', '2015-06-29 21:54:53.438982', '2015-06-29 22:50:42.043038', '2015-06-29 23:57:01.252743', '2015-06-30 00:55:47.956896', '2015-06-30 02:09:52.322133', '2015-06-30 03:03:39.383064', '2015-06-30 03:50:50.766858', '2015-06-30 04:50:39.615428', '2015-06-30 06:25:27.458109', '2015-06-30 07:55:11.204355', '2015-06-30 09:39:21.191083', '2015-06-30 10:22:45.997804', '2015-06-30 10:59:26.329209', '2015-06-30 11:50:48.939347', '2015-06-30 13:57:42.457778', '2015-06-30 14:50:48.473381', '2015-06-30 15:50:42.657485', '2015-06-30 17:06:52.258160', '2015-06-30 18:54:42.825924', '2015-06-30 19:50:40.600425', '2015-06-30 20:51:00.264911', '2015-06-30 21:57:22.242037', '2015-06-30 22:51:43.220925', '2015-06-30 23:54:59.820767', '2015-07-01 00:55:33.768383', '2015-07-01 01:53:26.904938', '2015-07-01 02:52:15.458075', '2015-07-01 04:05:23.488164', '2015-07-01 05:02:20.262929', '2015-07-01 07:16:38.360452', '2015-07-01 08:50:21.684230', '2015-07-01 08:57:35.840640', '2015-07-01 10:36:06.895235', '2015-07-01 11:03:23.079080', '2015-07-01 13:15:34.849122', '2015-07-01 13:50:45.590291', '2015-07-01 15:52:48.092809', '2015-07-01 16:50:43.655225', '2015-07-01 18:47:14.098886', '2015-07-01 18:52:50.790506', '2015-07-01 19:51:34.008680', '2015-07-01 21:08:42.158127', '2015-07-01 21:51:01.726946', '2015-07-01 22:50:42', '2015-07-01 23:51:59.660971', '2015-07-02 00:50:57.440082', '2015-07-02 01:51:31.819540', '2015-07-02 03:14:03.732551', '2015-07-02 03:52:44.809651', '2015-07-02 04:51:26.241890', '2015-07-02 05:59:59.603469', '2015-07-02 06:55:43.311305', '2015-07-02 07:57:27.218061', '2015-07-02 09:04:28.518146', '2015-07-02 10:10:05.137718', '2015-07-02 10:53:45.383014', '2015-07-02 12:09:48.833161', '2015-07-02 12:51:51.617634', '2015-07-02 14:02:51.216128', '2015-07-02 14:58:33.926629', '2015-07-02 15:52:49.892658', '2015-07-02 16:50:39.756773', '2015-07-02 17:50:53.153416', '2015-07-02 18:51:02.259916', '2015-07-02 21:03:14.073734', '2015-07-02 21:51:06.208249', '2015-07-02 22:50:52.137963', '2015-07-02 23:54:54.225252', '2015-07-03 00:54:20.068636', '2015-07-03 01:51:21.398311', '2015-07-03 02:50:39.683453', '2015-07-03 03:58:08.597186', '2015-07-03 04:50:47.896517', '2015-07-03 05:52:56.757792', '2015-07-03 07:10:51.566903', '2015-07-03 08:12:12.265343']
count_act_bins = [71, 33, 6, 0, 0, 0, 33, 1, 32, 0, 0, 1, 0, 0, 0, 0, 17, 0, 0, 0, 0, 0, 8, 43, 0, 1, 2, 0, 3, 20, 0, 12, 2, 0, 0, 0, 43, 4, 0, 0, 0, 0, 8, 0, 0, 5, 34, 0, 0, 0, 51, 8, 9, 0, 1, 7, 7, 21, 16, 3, 0, 4, 7, 0, 0, 0, 0, 0, 0, 0, 13, 0, 10, 11, 9, 0, 0, 21, 5, 0, 26, 0, 1, 21, 4, 0, 0, 0, 0, 1, 1, 1, 0, 0, 15, 11, 1, 0, 0, 0, 0, 3, 3, 3, 4, 2, 1, 0, 0, 0, 0, 0, 0, 6, 1, 23, 5, 0, 0, 13, 8, 0, 0, 22, 1, 11, 14, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 37, 4, 0, 0, 0, 6, 18, 7, 1, 0, 9, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 15, 33, 0, 0, 0, 29, 8, 0, 0, 4, 16, 4, 18, 0, 4, 0]


def convert_to_date_obj(date_list):
    """Convert dates to date objects """
    date_list_pr = date_list[:]
    for i in range(len(date_list)):
        try:
            date_list_pr[i] = (datetime.strptime(date_list[i], '%Y-%m-%d %H:%M:%S.%f'))
        except Exception:
            try:
                date_list_pr[i] = (datetime.strptime(date_list[i], '%Y-%m-%d %H:%M:%S'))
            except Exception:
                print(date_list[i])
    return date_list_pr

fig, ax = plt.subplots()
fig.canvas.draw()

labels = [item.get_text() for item in ax.get_xticklabels()]
labels[1] = 'Day 1'

ax.set_xticklabels(labels)

first_times = convert_to_date_obj(first_times)
#fig = plt.figure()
plt.bar(first_times,count_act_bins,width=0.01)
fig.autofmt_xdate()
plt.show()



xml = """ <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <items>
        <items_info>
            <title>Main Server</title>
            <genre>Sport</genre>
            <description>Main Server Listings</description>
            <thumbnail>http://173.com/wp/fan.jpg</thumbnail>
            <fanart>http://173.com/wp/fan1.jpg</fanart>
            <date>August 30, 2015</date>
            <credits>meio</credits>
        </items_info>
        <item>
          <title>test HD</title>
          <link>http://173.com/ne/plad69/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>test ch1 hdd</channel>
          <epgdata>catch up</epgdata>
      </item>
        <item>
          <title>aa help</title>
          <link>http://173.com/ne/plad60/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>aahe</channel>
          <epgdata>catch up</epgdata>
      </item>
        <item>
          <title>zs a help</title>
          <link>http://173.com/ne/plad64/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>zsahe</channel>
          <epgdata></epgdata>
      </item>
        <item>
          <title>gfg HD</title>
          <link>http://173.com/ne/plad46/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>ghd</channel>
          <epgdata></epgdata>
      </item>
        <item>
          <title>aa help hd</title>
          <link>http://173.com/ne/plad26/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>aahehd</channel>
          <epgdata>catch up</epgdata>
      </item>
        <item>
          <title>1234</title>
          <link>http://173.com/ne/plad61/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>334</channel>
          <epgdata></epgdata>
      </item>
        <item>
          <title>test 3443 hd</title>
          <link>http://173.com/ne/plad67/playlist.mp4</link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>boo</channel>
          <epgdata>catch up</epgdata>
      </item>
        <item>
          <title>zs a help hd</title>
          <link>http://173.com/ne/plad76/playlist.mp4/link>
          <fanart>http://173.com/wp/fan1.jpg</fanart>
          <genre>Sport</genre>
          <channel>zshelhd1</channel>
          <epgdata></epgdata>
      </item>
</items>
        </xml>"""

